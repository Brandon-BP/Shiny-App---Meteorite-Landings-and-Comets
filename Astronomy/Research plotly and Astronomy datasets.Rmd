---
title: "checker"
author: "Brandon Pazmino"
date: "12/28/2020"
output: html_document
---

```{r echo = FALSE}
stars <- read.csv("SDSS_stars.csv")
p = "https://astrostatistics.psu.edu/MSMA/datasets/asteroid_dens.dat"
sp = read.table(p, header = TRUE)
r = "https://astrostatistics.psu.edu/MSMA/datasets/NGC4406_profile.dat"
gal = read.table(r, header = TRUE) 
f = "https://astrostatistics.psu.edu/MSMA/datasets/NGC4472_profile.dat"
gal2 = read.table(f, header = TRUE) 

combo <- read.csv("COMBO17.csv")


test <- read.csv("SDSS_test.csv")
fireball <- read.csv("cneos_fireball_data.csv")
library(ggplot2)
library(highcharter)
library(magrittr)
meteor <- read.csv("Meteorite_Landings.csv")
library(plotly)
```

```{r}

p <- ggplot(sp, aes(Err, Dens, color = Asteroid)) + 
  geom_point() + 
  theme_bw()
ggplotly(p)
```

```{r}
library(highcharter)
hchart(sp, "point", hcaes(x = Err, y = Dens, group = Asteroid))

```
```{r}
hchart(sp, "line", hcaes(x = Err, y = Dens, group = Asteroid))

```
```{r}
#NGC4472 Galaxy 

hc<- hchart(gal2, type = "scatter", hcaes(radius,surf_mag),
            name = "Radius and Surface Mag of NGC4472 Galaxy",
            showInLegend = TRUE
)

hc

```
```{r}


fig <- plot_ly(fireball, x = ~Altitude_km, y = ~Velocity_km_s, z = ~Total_Radiated_Energy, marker = list(color = "blue"), showscale = TRUE )

fif <- fig %>% layout(scene = list(xaxis = list(title = "Altitude Km"),
                                   yaxis = list(title = "Velocity km/s"),
                                   zaxis = list(title = "Total Radiated Energy (J)")))

fig
```




**The Bubble Plot below is a vital ploy in understanding how Galaxies are observed through data. Here using plotly, we hage created an interactive bubble plot. our X is the Rmag which is the total red band magnitude, which is the inverted logarithmic measure of the galaxies brightness. The y is the difference between total and aperture magnitude in the R band. In other words, it is a rough measure of the size of the galaxy. the number below the coordinates of each bubble is the obect number ie the number the galaxy is classified as**

**The variable that effects the size of each bubble is mumax which is the central surface brightness of each galaxy**

**It is noted that the difference between R mag and mu_mx should be also be an indicator of the galaxy size**

```{r}




red <- plot_ly(combo, x = ~Rmag, y = ~ApDRmag, text = ~Nr, type = "scatter", mode = 'markers',
               marker = list(size = ~mumax, opacity = 0.5))
red <- red %>% layout(title = "Magnitude of Logarithmic Brightness Against size of Galaxy",
                      xaxis = list(showgrid = FALSE),
                      yaxis = list(showgrid = FALSE))

red



```



**Here we created a new variable where we took the difference in Rmag and mumax as this is also an indicator of a size of each galaxy recorded. we used this new variable as our y to compare and see how reliable it is estimating the size along with x still remaining as our RMag. For the most part, both plots seem to be similar, with a few remaining outliers in the second plot that do not occur in the first plot** 
```{r}
library(dplyr)

combo_n = mutate(combo, Diff_R_Mu = Rmag - mumax )

red2 <- plot_ly(combo_n, x = ~Rmag, y = ~Diff_R_Mu, text = ~Nr, type = "scatter", mode = 'markers', color = "red",marker = list(size = ~mumax, opacity = 0.5))

red2 <- red2 %>% layout(title = "Magnitude of Brightness against Estimated Size",
                        xaxis = list(showgrid = FALSE),
                        yaxis = list(showgird = FALSE))
red2

```



